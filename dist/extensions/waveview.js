/*
录音
https://github.com/xiangyuecn/Recorder
src: extensions/waveview.js
*/
!function(){var e=function(e){return new t(e)},t=function(e){var t=this,i={scale:2,lineWidth:2,linear1:[0,"rgba(150,97,236,1)",1,"rgba(54,197,252,1)"],linear2:[0,"rgba(209,130,253,0.6)",1,"rgba(54,197,252,0.6)"],linearBg:[0,"rgba(255,255,255,0.2)",1,"rgba(54,197,252,0.2)"]};for(var a in e)i[a]=e[a];t.set=e=i;var r=e.elem;r&&("string"==typeof r?r=document.querySelector(r):r.length&&(r=r[0])),r&&(e.width=r.offsetWidth,e.height=r.offsetHeight);var n=e.scale,h=e.width*n,o=e.height*n,l=t.elem=document.createElement("div");l.innerHTML='<div style="width:'+e.width+"px;height:"+e.height+'px;overflow:hidden"><div style="width:'+h+"px;height:"+o+"px;transform-origin:0 0;transform:scale("+1/n+')"><canvas/></div></div>';var g=t.canvas=l.querySelector("canvas"),s=t.ctx=g.getContext("2d");g.width=h,g.height=o,t.linear1=t.genLinear(s,h,e.linear1),t.linear2=t.genLinear(s,h,e.linear2),t.linearBg=t.genLinear(s,o,e.linearBg,!0),r&&(r.innerHTML="",r.appendChild(l)),t._phase=0};t.prototype=e.prototype={genLinear:function(e,t,i,a){for(var r=e.createLinearGradient(0,0,a?0:t,a?t:0),n=0;n<i.length;)r.addColorStop(i[n++],i[n++]);return r},genPath:function(e,t,i){for(var a=[],r=this.set,n=r.scale,h=r.width*n,o=r.height*n/2,l=0;l<h;l+=n){var g=(1+Math.cos(Math.PI+l/h*2*Math.PI))/2*o*t*Math.sin(2*Math.PI*(l/h)*e+i)+o;a.push(g)}return a},input:function(e,t,i){var a=this,r=a.set,n=a.ctx,h=r.scale,o=r.width*h,l=r.height*h,g=a._phase-=.22,s=t/100,d=a.genPath(2,s,g),c=a.genPath(1.8,s,g+3);n.clearRect(0,0,o,l),n.beginPath();for(var v=0,f=0;f<o;v++,f+=h)0==f?n.moveTo(f,d[v]):n.lineTo(f,d[v]);v--;for(f=o-1;0<=f;v--,f-=h)n.lineTo(f,c[v]);n.closePath(),n.fillStyle=a.linearBg,n.fill(),a.drawPath(c,a.linear2),a.drawPath(d,a.linear1)},drawPath:function(e,t){var i=this.set,a=this.ctx,r=i.scale,n=i.width*r;a.beginPath();for(var h=0,o=0;o<n;h++,o+=r)0==o?a.moveTo(o,e[h]):a.lineTo(o,e[h]);a.lineWidth=i.lineWidth*r,a.strokeStyle=t,a.stroke()}},Recorder.WaveView=e}();